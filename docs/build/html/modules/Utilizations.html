<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="PyTorch Utilizations" href="PyTorch_Utilizations.html" /><link rel="prev" title="License" href="../license.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.07.18 -->
        <title>Utilizations - YCSAI 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=613ab9ff" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=93a78b65" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">YCSAI 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">YCSAI 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">GET STARTED</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../license.html">License</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of License</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Utilizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="PyTorch_Utilizations.html">PyTorch Utilizations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/YCSAI_API.html">Tutorial YCSAI API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/modules/Utilizations.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="utilizations">
<h1>Utilizations<a class="headerlink" href="#utilizations" title="Permalink to this heading">¶</a></h1>
<span class="target" id="module-ycsai.utils.general"></span><dl class="py class">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">ConfusionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p>The ConfusionMatrix class is designed to compute and visualize the confusion matrix for object detection tasks. It processes batches of detections and ground truth labels, updates the confusion matrix, and provides methods to plot and print the matrix.</p>
</section>
<section id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>nc (int): Number of classes.</p>
<p>conf (float): Confidence threshold for detections. Default is 0.25.</p>
<p>iou_thres (float): IoU threshold for determining matches between detections and ground truth. Default is 0.45.</p>
</div></blockquote>
</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the confusion matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix.plot" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Plots the confusion matrix.</dt><dd><p>normalize (bool): If True, normalizes the confusion matrix by dividing each column by its sum. Default is True.</p>
<p>save_dir (str): Directory where the plot image will be saved. Default is ‘’.</p>
<p>names (tuple): Class names to be used as labels on the plot. Default is an empty tuple ().</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix.print" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the confusion matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix.process_batch">
<span class="sig-name descname"><span class="pre">process_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix.process_batch" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Updates the confusion matrix with a batch of detections and labels.</dt><dd><p>detections (Array[N, 6]): x1, y1, x2, y2, conf, class</p>
<p>labels (Array[M, 5]): class, x1, y1, x2, y2</p>
<p>Return: None, updates confusion matrix accordingly</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.ConfusionMatrix.tp_fp">
<span class="sig-name descname"><span class="pre">tp_fp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ConfusionMatrix.tp_fp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true positives and false positives for each class.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ycsai.utils.general.Profile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">Profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.Profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ContextDecorator</span></code></p>
<section id="id1">
<h2>Description<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>The Profile class is a context manager and decorator for profiling code execution time. It measures the time taken for a block of code or function to execute and can accumulate the total time over multiple usages.</p>
</section>
<section id="id2">
<h2>Arguments<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>t (float): Initial accumulated time. Default is 0.0.</p>
</div></blockquote>
</section>
<section id="id3">
<h2>Methods<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>init(self, t=0.0): Initializes the profiler with an optional initial accumulated time.</p>
<p>enter(self): Starts the timer when entering the context.</p>
<p>exit(self, type, value, traceback): Stops the timer when exiting the context and updates the accumulated time.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="ycsai.utils.general.Profile.time">
<span class="sig-name descname"><span class="pre">time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.Profile.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current time, with synchronization if CUDA is available.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ycsai.utils.general.TryExcept">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">TryExcept</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.TryExcept" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ContextDecorator</span></code></p>
<section id="id4">
<h2>Description<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>The TryExcept class is a context manager and decorator designed to catch and handle exceptions, printing a custom message along with the exception details. It can be used both as a decorator and within a with statement.</p>
</section>
<section id="id5">
<h2>Arguments<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>msg (str): A custom message to print along with the exception details. Default is an empty string ‘’.</p>
</div></blockquote>
</section>
<section id="id6">
<h2>Methods<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>init(self, msg=’’): Initializes the context manager with an optional custom message.</p>
<p>enter(self): No operation is performed when entering the context.</p>
<p>exit(self, exc_type, value, traceback): Catches any exceptions, prints the custom message and exception details, and suppresses the exception.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.ap_per_class">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">ap_per_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.ap_per_class" title="Permalink to this definition">¶</a></dt>
<dd><section id="id7">
<h2>Description<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<p>The ap_per_class function computes the average precision (AP) for each class given the true positives, confidence scores, predicted classes, and target classes. It can also plot precision-recall curves and other related metrics. Source: <a class="reference external" href="https://github.com/rafaelpadilla/Object-Detection-Metrics">https://github.com/rafaelpadilla/Object-Detection-Metrics</a>.</p>
</section>
<section id="id8">
<h2>Arguments<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>tp (np.ndarray): True positives (nx1 or nx10).</p>
<p>conf (np.ndarray): Objectness value from 0 to 1.</p>
<p>pred_cls (np.ndarray): Predicted object classes.</p>
<p>target_cls (np.ndarray): True object classes.</p>
<p>plot (bool): If True, plots the precision-recall curve at <a class="reference external" href="mailto:mAP&#37;&#52;&#48;0&#46;5">mAP<span>&#64;</span>0<span>&#46;</span>5</a>. Default is False.</p>
<p>save_dir (str): Directory to save the plot. Default is ‘.’.</p>
<p>names (dict): Class names dictionary.</p>
<p>eps (float): Small value to avoid division by zero. Default is 1e-16.</p>
<p>prefix (str): Prefix for plot filenames. Default is “”.</p>
</div></blockquote>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>tp (np.ndarray): True positives per class.</p>
<p>fp (np.ndarray): False positives per class.</p>
<p>p (np.ndarray): Precision per class.</p>
<p>r (np.ndarray): Recall per class.</p>
<p>f1 (np.ndarray): F1 score per class.</p>
<p>ap (np.ndarray): Average precision per class.</p>
<p>unique_classes (np.ndarray): Array of unique class indices.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.bbox2dist">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">bbox2dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.bbox2dist" title="Permalink to this definition">¶</a></dt>
<dd><section id="id9">
<h2>Description<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h2>
<p>The bbox2dist function transforms bounding box coordinates in (x1, y1, x2, y2) format to distance format (left, top, right, bottom) relative to anchor points.</p>
</section>
<section id="id10">
<h2>Arguments<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>anchor_points (torch.Tensor): A tensor of shape (n, 2) representing the anchor points with (x, y) coordinates.</p>
<p>bbox (torch.Tensor): A tensor of shape (n, 4) representing bounding boxes in (x1, y1, x2, y2) format.</p>
<p>reg_max (float): The maximum allowable value for the distance.</p>
</div></blockquote>
</section>
<section id="id11">
<h2>Returns<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>distances (torch.Tensor): A tensor of shape (n, 4) representing the distances from the anchor points to the sides of the bounding boxes in (left, top, right, bottom) format.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.bbox_iou">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">bbox_iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xywh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GIoU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DIoU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CIoU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MDPIoU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">640</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">640</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.bbox_iou" title="Permalink to this definition">¶</a></dt>
<dd><section id="id12">
<h2>Description<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h2>
<p>The bbox_iou function calculates the Intersection over Union (IoU) and its variants (GIoU, DIoU, CIoU, MDPIoU) between a single bounding box and a set of bounding boxes. It can handle both (x, y, w, h) and (x1, y1, x2, y2) formats.</p>
</section>
<section id="id13">
<h2>Arguments<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>box1 (torch.Tensor): A tensor of shape (1, 4) representing a single bounding box.</p>
<p>box2 (torch.Tensor): A tensor of shape (n, 4) representing multiple bounding boxes.</p>
<p>xywh (bool): If True, the bounding boxes are in (x, y, w, h) format. If False, they are in (x1, y1, x2, y2) format. Default is True.</p>
<p>GIoU (bool): If True, calculate Generalized IoU. Default is False.</p>
<p>DIoU (bool): If True, calculate Distance IoU. Default is False.</p>
<p>CIoU (bool): If True, calculate Complete IoU. Default is False.</p>
<p>MDPIoU (bool): If True, calculate Modified Distance IoU. Default is False.</p>
<p>feat_h (int): Height of the feature map used for MDPIoU calculation. Default is 640.</p>
<p>feat_w (int): Width of the feature map used for MDPIoU calculation. Default is 640.</p>
<p>eps (float): A small value to avoid division by zero. Default is 1e-7.</p>
</div></blockquote>
</section>
<section id="id14">
<h2>Returns<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>iou (torch.Tensor): A tensor containing the IoU or its variants for each pair of bounding boxes.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.box_iou">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">box_iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.box_iou" title="Permalink to this definition">¶</a></dt>
<dd><section id="id15">
<h2>Description<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h2>
<p>The box_iou function computes the Intersection-over-Union (IoU), also known as the Jaccard index, between two sets of bounding boxes. The IoU is a measure of the overlap between two bounding boxes and is used extensively in object detection tasks.</p>
</section>
<section id="id16">
<h2>Arguments<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>box1 (torch.Tensor): A tensor of shape (N, 4) representing the first set of bounding boxes, where each box is defined by (x1, y1, x2, y2).</p>
<p>box2 (torch.Tensor): A tensor of shape (M, 4) representing the second set of bounding boxes, where each box is defined by (x1, y1, x2, y2).</p>
<p>eps (float): A small value added to the denominator for numerical stability. Default is 1e-7.</p>
</div></blockquote>
</section>
<section id="id17">
<h2>Returns<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>iou (torch.Tensor): A tensor of shape (N, M) containing the pairwise IoU values for each pair of bounding boxes from box1 and box2.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_amp">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_amp" title="Permalink to this definition">¶</a></dt>
<dd><section id="id18">
<h2>Description<a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h2>
<p>The check_amp function checks if PyTorch Automatic Mixed Precision (AMP) functionality is available and can be used with the given model. It returns True if AMP can be used, otherwise False.</p>
</section>
<section id="id19">
<h2>Arguments<a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>model (torch.nn.Module): The PyTorch model to check for AMP compatibility.</p>
</div></blockquote>
</section>
<section id="id20">
<h2>Returns<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>result (bool): True if AMP can be used, False otherwise.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_dataset">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autodownload</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_dataset" title="Permalink to this definition">¶</a></dt>
<dd><section id="id21">
<h2>Description<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h2>
<p>The check_dataset function checks and prepares a dataset configuration dictionary. It validates necessary fields, resolves paths, and optionally downloads the dataset if paths are missing.</p>
</section>
<section id="id22">
<h2>Arguments<a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>data (str, Path, dict): The dataset configuration as a file path or dictionary.</p>
<p>autodownload (bool): If True, attempts to download the dataset if paths are missing. Default is True.</p>
</div></blockquote>
</section>
<section id="id23">
<h2>Returns<a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>data (dict): The validated and updated dataset configuration dictionary.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_font">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">font</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Arial.ttf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_font" title="Permalink to this definition">¶</a></dt>
<dd><section id="id24">
<h2>Description<a class="headerlink" href="#id24" title="Permalink to this heading">¶</a></h2>
<p>The check_font function checks if a specified font file exists locally. If not, it downloads the font file to a configuration directory.</p>
</section>
<section id="id25">
<h2>Arguments<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>font (Path or str): The path to the font file. Default is FONT.</p>
<p>progress (bool): If True, displays a progress bar during download. Default is False.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_img_size">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_img_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgsz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_img_size" title="Permalink to this definition">¶</a></dt>
<dd><section id="id26">
<h2>Description<a class="headerlink" href="#id26" title="Permalink to this heading">¶</a></h2>
<p>The check_img_size function verifies that the given image size is a multiple of a specified stride. If the image size is not a multiple, it adjusts the size accordingly and logs a warning.</p>
</section>
<section id="id27">
<h2>Arguments<a class="headerlink" href="#id27" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>imgsz (int or list/tuple of int): The image size. It can be an integer (for square images) or a list/tuple of integers (for width and height).</p>
<p>s (int): The stride value that the image size must be a multiple of. Default is 32.</p>
<p>floor (int): The minimum allowable value for the image size. Default is 0.</p>
</div></blockquote>
</section>
<section id="id28">
<h2>Returns<a class="headerlink" href="#id28" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>new_size (int or list of int): The adjusted image size that is a multiple of the stride.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_suffix">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'yolo.pt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('.pt',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_suffix" title="Permalink to this definition">¶</a></dt>
<dd><section id="id29">
<h2>Description<a class="headerlink" href="#id29" title="Permalink to this heading">¶</a></h2>
<p>The check_suffix function checks if the given file(s) have an acceptable suffix and raises an assertion error if they do not.</p>
</section>
<section id="id30">
<h2>Arguments<a class="headerlink" href="#id30" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>file (str, list, tuple): The file path or a list/tuple of file paths to check. Default is ‘yolo.pt’.</p>
<p>suffix (str, list, tuple): The acceptable suffix or a list/tuple of acceptable suffixes. Default is (‘.pt’,).</p>
<p>msg (str): An optional message to prepend to the assertion error message. Default is ‘’.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.check_version">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">check_version</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.0.0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.0.0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'version</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.check_version" title="Permalink to this definition">¶</a></dt>
<dd><section id="id31">
<h2>Description<a class="headerlink" href="#id31" title="Permalink to this heading">¶</a></h2>
<p>The check_version function checks if the current version meets or exceeds a specified minimum version. It supports strict comparisons (exact match or minimum requirement) and optional logging.</p>
</section>
<section id="id32">
<h2>Arguments<a class="headerlink" href="#id32" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>current (str): The current version string. Default is ‘0.0.0’.</p>
<p>minimum (str): The minimum required version string. Default is ‘0.0.0’.</p>
<p>name (str): A string to identify the version being checked. Default is ‘version ‘.</p>
<p>pinned (bool): If True, checks if the current version exactly matches the minimum version. Default is False.</p>
<p>hard (bool): If True, raises an error if the minimum requirements are not met. Default is False.</p>
<p>verbose (bool): If True, logs a warning message if the minimum requirements are not met. Default is False.</p>
</div></blockquote>
</section>
<section id="id33">
<h2>Returns<a class="headerlink" href="#id33" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>(bool): Returns True if the current version meets the required version criteria, otherwise False.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.clip_boxes">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">clip_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.clip_boxes" title="Permalink to this definition">¶</a></dt>
<dd><section id="id34">
<h2>Description<a class="headerlink" href="#id34" title="Permalink to this heading">¶</a></h2>
<p>The clip_boxes function clips the coordinates of bounding boxes to fit within the specified image shape. This ensures that the bounding boxes do not extend outside the boundaries of the image.</p>
</section>
<section id="id35">
<h2>Arguments<a class="headerlink" href="#id35" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>boxes (torch.Tensor or np.ndarray): A tensor or numpy array of shape (n, 4) representing bounding boxes in (x1, y1, x2, y2) format.</p>
<p>shape (tuple): A tuple representing the image shape as (height, width).</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.compute_ap">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">compute_ap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.compute_ap" title="Permalink to this definition">¶</a></dt>
<dd><section id="id36">
<h2>Description<a class="headerlink" href="#id36" title="Permalink to this heading">¶</a></h2>
<p>The compute_ap function computes the Average Precision (AP) given the recall and precision curves. AP is a popular metric used in evaluating object detection models.</p>
</section>
<section id="id37">
<h2>Arguments<a class="headerlink" href="#id37" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>recall (list or np.ndarray): The recall curve.</p>
<p>precision (list or np.ndarray): The precision curve.</p>
</div></blockquote>
</section>
<section id="id38">
<h2>Returns<a class="headerlink" href="#id38" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>ap (float): The average precision.</p>
<p>mpre (np.ndarray): The precision curve with sentinel values.</p>
<p>mrec (np.ndarray): The recall curve with sentinel values.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.dist2bbox">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">dist2bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xywh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.dist2bbox" title="Permalink to this definition">¶</a></dt>
<dd><section id="id39">
<h2>Description<a class="headerlink" href="#id39" title="Permalink to this heading">¶</a></h2>
<p>The dist2bbox function transforms distances from anchor points to bounding box coordinates. The output can be in either (x, y, width, height) format or (x1, y1, x2, y2) format.</p>
</section>
<section id="id40">
<h2>Arguments<a class="headerlink" href="#id40" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>distance (torch.Tensor): A tensor representing distances (left, top, right, bottom) from anchor points.</p>
<p>anchor_points (torch.Tensor): A tensor representing the anchor points.</p>
<p>xywh (bool): If True, the output bounding boxes are in (x, y, width, height) format. If False, the output is in (x1, y1, x2, y2) format. Default is True.</p>
<p>dim (int): The dimension along which to split the distance tensor. Default is -1.</p>
</div></blockquote>
</section>
<section id="id41">
<h2>Returns<a class="headerlink" href="#id41" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>bboxes (torch.Tensor): The transformed bounding boxes in the specified format.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.fitness">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">fitness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.fitness" title="Permalink to this definition">¶</a></dt>
<dd><section id="id42">
<h2>Description<a class="headerlink" href="#id42" title="Permalink to this heading">¶</a></h2>
<p>The fitness function calculates the fitness of a model based on a weighted combination of precision, recall, and mean Average Precision (mAP) metrics. This fitness score is used to evaluate and compare model performance.</p>
</section>
<section id="id43">
<h2>Arguments<a class="headerlink" href="#id43" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>x (np.ndarray): A 2D array where each row contains the metrics [P, R, <a class="reference external" href="mailto:mAP&#37;&#52;&#48;0&#46;5">mAP<span>&#64;</span>0<span>&#46;</span>5</a>, <a class="reference external" href="mailto:mAP&#37;&#52;&#48;0&#46;5">mAP<span>&#64;</span>0<span>&#46;</span>5</a>:0.95] for a different model or experiment.</p>
</div></blockquote>
</section>
<section id="id44">
<h2>Returns<a class="headerlink" href="#id44" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>fitness_scores (np.ndarray): A 1D array containing the fitness score for each row in x.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.increment_path">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">increment_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exist_ok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mkdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.increment_path" title="Permalink to this definition">¶</a></dt>
<dd><section id="id45">
<h2>Description<a class="headerlink" href="#id45" title="Permalink to this heading">¶</a></h2>
<p>The increment_path function generates an incremented file or directory path if the given path already exists. For example, if runs/exp exists, it will generate runs/exp2, runs/exp3, etc., until a non-existent path is found. It can also create the directory if specified.</p>
</section>
<section id="id46">
<h2>Arguments<a class="headerlink" href="#id46" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>path (str): The initial file or directory path.</p>
<p>exist_ok (bool): If True, does not increment the path even if it exists. Default is False.</p>
<p>sep (str): The separator to use between the base path and the increment number. Default is ‘’.</p>
<p>mkdir (bool): If True, creates the directory at the incremented path. Default is False.</p>
</div></blockquote>
</section>
<section id="id47">
<h2>Returns<a class="headerlink" href="#id47" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>path (Path): The incremented path as a Path object.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.intersect_dicts">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">intersect_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.intersect_dicts" title="Permalink to this definition">¶</a></dt>
<dd><section id="id48">
<h2>Description<a class="headerlink" href="#id48" title="Permalink to this heading">¶</a></h2>
<p>The intersect_dicts function returns the intersection of two dictionaries based on matching keys and shapes of their values, while excluding specified keys.</p>
</section>
<section id="id49">
<h2>Arguments<a class="headerlink" href="#id49" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>da (dict): The first dictionary.</p>
<p>db (dict): The second dictionary.</p>
<p>exclude (tuple): A tuple of keys to exclude from the intersection. Default is an empty tuple.</p>
</div></blockquote>
</section>
<section id="id50">
<h2>Returns<a class="headerlink" href="#id50" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>intersection (dict): A dictionary containing the intersection of da and db based on matching keys and shapes, excluding specified keys.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.is_ascii">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">is_ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.is_ascii" title="Permalink to this definition">¶</a></dt>
<dd><section id="id51">
<h2>Description<a class="headerlink" href="#id51" title="Permalink to this heading">¶</a></h2>
<p>Is string composed of all ASCII (no UTF) characters? (note str().isascii() introduced in python 3.7)</p>
</section>
<section id="id52">
<h2>Arguments<a class="headerlink" href="#id52" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>s : string</p>
</div></blockquote>
</section>
<section id="id53">
<h2>Returns<a class="headerlink" href="#id53" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>(bool)</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.is_writeable">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">is_writeable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.is_writeable" title="Permalink to this definition">¶</a></dt>
<dd><section id="id54">
<h2>Description<a class="headerlink" href="#id54" title="Permalink to this heading">¶</a></h2>
<p>The is_writeable function checks if a directory has write permissions. Optionally, it can test writing to the directory by creating and deleting a temporary file.</p>
</section>
<section id="id55">
<h2>Arguments<a class="headerlink" href="#id55" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>dir (str or Path): The directory to check for write permissions.</p>
<p>test (bool): If True, test writing by creating and deleting a temporary file. Default is False.</p>
</div></blockquote>
</section>
<section id="id56">
<h2>Returns<a class="headerlink" href="#id56" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>(bool): True if the directory has write permissions, otherwise False.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.labels_to_class_weights">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">labels_to_class_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.labels_to_class_weights" title="Permalink to this definition">¶</a></dt>
<dd><section id="id57">
<h2>Description<a class="headerlink" href="#id57" title="Permalink to this heading">¶</a></h2>
<p>The labels_to_class_weights function calculates class weights based on the inverse frequency of class occurrences in the training labels. These weights are useful for balancing the training process when classes are imbalanced.</p>
</section>
<section id="id58">
<h2>Arguments<a class="headerlink" href="#id58" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>labels (list of numpy arrays): A list of label arrays, where each label array corresponds to an image and has the format [class, x, y, w, h].</p>
<p>nc (int): The number of classes. Default is 80.</p>
</div></blockquote>
</section>
<section id="id59">
<h2>Returns<a class="headerlink" href="#id59" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>weights (torch.Tensor): A tensor containing the normalized class weights.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.make_anchors">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">make_anchors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strides</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_cell_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.make_anchors" title="Permalink to this definition">¶</a></dt>
<dd><section id="id60">
<h2>Description<a class="headerlink" href="#id60" title="Permalink to this heading">¶</a></h2>
<p>The make_anchors function generates anchor points from feature maps and their corresponding strides. These anchors are used in object detection tasks to predict bounding boxes at different scales and locations.</p>
</section>
<section id="id61">
<h2>Arguments<a class="headerlink" href="#id61" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>feats (list of torch.Tensor): A list of feature maps from different layers of a neural network.</p>
<p>strides (list of int): A list of stride values corresponding to each feature map.</p>
<p>grid_cell_offset (float): Offset value for the grid cell centers. Default is 0.5.</p>
</div></blockquote>
</section>
<section id="id62">
<h2>Returns<a class="headerlink" href="#id62" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>anchor_points (torch.Tensor): A tensor containing the anchor points.</p>
<p>stride_tensor (torch.Tensor): A tensor containing the stride values for each anchor point.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.make_divisible">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">make_divisible</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">divisor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.make_divisible" title="Permalink to this definition">¶</a></dt>
<dd><section id="id63">
<h2>Description<a class="headerlink" href="#id63" title="Permalink to this heading">¶</a></h2>
<p>The make_divisible function returns the nearest integer greater than or equal to x that is divisible by divisor.</p>
</section>
<section id="id64">
<h2>Arguments<a class="headerlink" href="#id64" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>x (float, int): The number to be adjusted to the nearest divisible number.</p>
<p>divisor (int, torch.Tensor): The divisor by which the result should be divisible. If a torch.Tensor is provided, the maximum value of the tensor is used as the divisor.</p>
</div></blockquote>
</section>
<section id="id65">
<h2>Returns<a class="headerlink" href="#id65" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>result (int): The nearest integer greater than or equal to x that is divisible by divisor.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.non_max_suppression">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">non_max_suppression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iou_thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agnostic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_det</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.non_max_suppression" title="Permalink to this definition">¶</a></dt>
<dd><section id="id66">
<h2>Description<a class="headerlink" href="#id66" title="Permalink to this heading">¶</a></h2>
<p>The non_max_suppression function performs Non-Maximum Suppression (NMS) on the inference results to reject overlapping detections. It filters out low-confidence detections and removes redundant bounding boxes based on their Intersection over Union (IoU).</p>
</section>
<section id="id67">
<h2>Arguments<a class="headerlink" href="#id67" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>prediction (torch.Tensor): The model’s output tensor of shape (batch_size, num_predictions, 5 + num_classes + num_masks).</p>
<p>conf_thres (float): Confidence threshold to filter detections. Default is 0.25.</p>
<p>iou_thres (float): IoU threshold for NMS. Default is 0.45.</p>
<p>classes (list of int, optional): List of class indices to keep. Default is None.</p>
<p>agnostic (bool): If True, NMS is class-agnostic. Default is False.</p>
<p>multi_label (bool): If True, allows multiple labels per box. Default is False.</p>
<p>labels (list of torch.Tensor, optional): List of ground truth labels for auto-labelling. Default is ().</p>
<p>max_det (int): Maximum number of detections per image. Default is 300.</p>
<p>nm (int): Number of masks. Default is 0.</p>
</div></blockquote>
</section>
<section id="id68">
<h2>Returns<a class="headerlink" href="#id68" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>output (list of torch.Tensor): List of tensors, one for each image in the batch, each of shape (n, 6 + num_masks) containing detections [x1, y1, x2, y2, conf, cls, mask…].</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.one_cycle">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">one_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.one_cycle" title="Permalink to this definition">¶</a></dt>
<dd><section id="id69">
<h2>Description<a class="headerlink" href="#id69" title="Permalink to this heading">¶</a></h2>
<p>The one_cycle function generates a lambda function that computes a sinusoidal ramp from y1 to y2 over a specified number of steps. This is typically used for learning rate schedules in training neural networks.</p>
</section>
<section id="id70">
<h2>Arguments<a class="headerlink" href="#id70" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>y1 (float): The starting value of the ramp. Default is 0.0.</p>
<p>y2 (float): The ending value of the ramp. Default is 1.0.</p>
<p>steps (int): The number of steps over which the ramp progresses. Default is 100.</p>
</div></blockquote>
</section>
<section id="id71">
<h2>Returns<a class="headerlink" href="#id71" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>ramp_function (function): A lambda function that computes the value at step x in the ramp.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.one_flat_cycle">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">one_flat_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.one_flat_cycle" title="Permalink to this definition">¶</a></dt>
<dd><section id="id72">
<h2>Description<a class="headerlink" href="#id72" title="Permalink to this heading">¶</a></h2>
<p>The one_flat_cycle function generates a lambda function that computes a sinusoidal ramp from y1 to y2 over a specified number of steps, with the first half of the steps remaining flat at y1. This can be useful for certain learning rate schedules where an initial flat period is desired.</p>
</section>
<section id="id73">
<h2>Arguments<a class="headerlink" href="#id73" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>y1 (float): The starting value and the flat value for the first half of the steps. Default is 0.0.</p>
<p>y2 (float): The ending value of the ramp. Default is 1.0.</p>
<p>steps (int): The total number of steps over which the ramp progresses. Default is 100.</p>
</div></blockquote>
</section>
<section id="id74">
<h2>Returns<a class="headerlink" href="#id74" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>ramp_function (function): A lambda function that computes the value at step x in the ramp.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.scale_boxes">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">scale_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img1_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img0_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.scale_boxes" title="Permalink to this definition">¶</a></dt>
<dd><section id="id75">
<h2>Description<a class="headerlink" href="#id75" title="Permalink to this heading">¶</a></h2>
<p>The scale_boxes function rescales bounding boxes from one image shape to another. This is useful for adjusting bounding boxes after resizing or padding operations on the images.</p>
</section>
<section id="id76">
<h2>Arguments<a class="headerlink" href="#id76" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>img1_shape (tuple): Shape of the image after resizing/padding as (height, width).</p>
<p>boxes (torch.Tensor or np.ndarray): A tensor or numpy array of shape (n, 4) representing bounding boxes in (x1, y1, x2, y2) format.</p>
<p>img0_shape (tuple): Original shape of the image as (height, width).</p>
<p>ratio_pad (tuple, optional): A tuple containing the scaling ratio and padding. If not provided, it will be calculated from img0_shape.</p>
</div></blockquote>
</section>
<section id="id77">
<h2>Returns<a class="headerlink" href="#id77" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>boxes (torch.Tensor or np.ndarray): Rescaled bounding boxes adjusted to the original image shape.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.scale_image">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">scale_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im1_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">im0_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.scale_image" title="Permalink to this definition">¶</a></dt>
<dd><section id="id78">
<h2>Description<a class="headerlink" href="#id78" title="Permalink to this heading">¶</a></h2>
<p>The scale_image function rescales masks from the model input shape to the original image shape. This is useful for mapping masks back to the original image size after they have been processed by the model.</p>
</section>
<section id="id79">
<h2>Arguments<a class="headerlink" href="#id79" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>im1_shape (tuple): Shape of the model input image as [height, width].</p>
<p>masks (np.ndarray): Array of masks with shape [height, width, num] or [height, width].</p>
<p>im0_shape (tuple): Shape of the original image as [height, width, channels].</p>
<p>ratio_pad (tuple, optional): A tuple containing the scaling ratio and padding. If not provided, it will be calculated from im0_shape.</p>
</div></blockquote>
</section>
<section id="id80">
<h2>Returns<a class="headerlink" href="#id80" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>masks (np.ndarray): Rescaled masks adjusted to the original image shape.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.strip_optimizer">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">strip_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best.pt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.strip_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><section id="id81">
<h2>Description<a class="headerlink" href="#id81" title="Permalink to this heading">¶</a></h2>
<p>The strip_optimizer function removes unnecessary components from a PyTorch model checkpoint, such as the optimizer state, to finalize the model for inference. This process reduces the file size and prepares the model for deployment. Optionally, the function can save the modified checkpoint to a new file.</p>
</section>
<section id="id82">
<h2>Arguments<a class="headerlink" href="#id82" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>f (str): Path to the model checkpoint file. Default is ‘best.pt’.</p>
<p>s (str): Path to save the stripped model checkpoint. If not provided, the original file will be overwritten. Default is ‘’.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.user_config_dir">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">user_config_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ultralytics'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'YOLOV5_CONFIG_DIR'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.user_config_dir" title="Permalink to this definition">¶</a></dt>
<dd><section id="id83">
<h2>Description<a class="headerlink" href="#id83" title="Permalink to this heading">¶</a></h2>
<p>The user_config_dir function returns the path to the user configuration directory. It prioritizes the directory specified by an environment variable, and if not set, it uses OS-specific default directories. If necessary, the directory is created.</p>
</section>
<section id="id84">
<h2>Arguments<a class="headerlink" href="#id84" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>dir (str): The name of the directory to create/use within the user configuration directory. Default is ‘Ultralytics’.</p>
<p>env_var (str): The name of the environment variable to check for a custom configuration directory. Default is ‘YOLOV5_CONFIG_DIR’.</p>
</div></blockquote>
</section>
<section id="id85">
<h2>Returns<a class="headerlink" href="#id85" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>path (Path): The path to the user configuration directory.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.xywh2xyxy">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">xywh2xyxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.xywh2xyxy" title="Permalink to this definition">¶</a></dt>
<dd><section id="id86">
<h2>Description<a class="headerlink" href="#id86" title="Permalink to this heading">¶</a></h2>
<p>The xywh2xyxy function converts bounding boxes from (x, y, w, h) format to (x1, y1, x2, y2) format, where x1, y1 is the top-left corner and x2, y2 is the bottom-right corner.</p>
</section>
<section id="id87">
<h2>Arguments<a class="headerlink" href="#id87" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>x (torch.Tensor or np.ndarray): A tensor or numpy array of shape (n, 4) representing bounding boxes in (x, y, w, h) format.</p>
</div></blockquote>
</section>
<section id="id88">
<h2>Returns<a class="headerlink" href="#id88" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>y (torch.Tensor or np.ndarray): A tensor or numpy array of the same shape as x, with bounding boxes in (x1, y1, x2, y2) format.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.xyxy2xywh">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">xyxy2xywh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.xyxy2xywh" title="Permalink to this definition">¶</a></dt>
<dd><section id="id89">
<h2>Description<a class="headerlink" href="#id89" title="Permalink to this heading">¶</a></h2>
<p>The xyxy2xywh function converts bounding boxes from (x1, y1, x2, y2) format to (x, y, w, h) format, where x1, y1 is the top-left corner and x2, y2 is the bottom-right corner.</p>
</section>
<section id="id90">
<h2>Arguments<a class="headerlink" href="#id90" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>x (torch.Tensor or np.ndarray): A tensor or numpy array of shape (n, 4) representing bounding boxes in (x1, y1, x2, y2) format.</p>
</div></blockquote>
</section>
<section id="id91">
<h2>Returns<a class="headerlink" href="#id91" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>y (torch.Tensor or np.ndarray): A tensor or numpy array of the same shape as x, with bounding boxes in (x, y, w, h) format.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.yaml_load">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">yaml_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data.yaml'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.yaml_load" title="Permalink to this definition">¶</a></dt>
<dd><section id="id92">
<h2>Description<a class="headerlink" href="#id92" title="Permalink to this heading">¶</a></h2>
<p>The yaml_load function loads and returns the contents of a YAML file as a Python dictionary.</p>
</section>
<section id="id93">
<h2>Arguments<a class="headerlink" href="#id93" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>file (str): The file path of the YAML file to be loaded. Default is ‘data.yaml’.</p>
</div></blockquote>
</section>
<section id="id94">
<h2>Returns<a class="headerlink" href="#id94" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>data (dict): The contents of the YAML file as a dictionary.</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ycsai.utils.general.yaml_save">
<span class="sig-prename descclassname"><span class="pre">ycsai.utils.general.</span></span><span class="sig-name descname"><span class="pre">yaml_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data.yaml'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ycsai.utils.general.yaml_save" title="Permalink to this definition">¶</a></dt>
<dd><section id="id95">
<h2>Description<a class="headerlink" href="#id95" title="Permalink to this heading">¶</a></h2>
<p>The yaml_save function saves a dictionary to a YAML file in a safe format, converting any Path objects to strings.</p>
</section>
<section id="id96">
<h2>Arguments<a class="headerlink" href="#id96" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>file (str): The file path where the YAML data will be saved. Default is ‘data.yaml’.</p>
<p>data (dict): The dictionary to be saved to the YAML file. Default is an empty dictionary {}.</p>
</div></blockquote>
</section>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="PyTorch_Utilizations.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">PyTorch Utilizations</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../license.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">License</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; SPHERE AX. All rights reserved.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Utilizations</a><ul>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a><ul>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix.matrix"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix.matrix()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix.plot"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix.plot()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix.print"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix.print()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix.process_batch"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix.process_batch()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.ConfusionMatrix.tp_fp"><code class="docutils literal notranslate"><span class="pre">ConfusionMatrix.tp_fp()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ycsai.utils.general.Profile"><code class="docutils literal notranslate"><span class="pre">Profile</span></code></a><ul>
<li><a class="reference internal" href="#ycsai.utils.general.Profile.time"><code class="docutils literal notranslate"><span class="pre">Profile.time()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ycsai.utils.general.TryExcept"><code class="docutils literal notranslate"><span class="pre">TryExcept</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.ap_per_class"><code class="docutils literal notranslate"><span class="pre">ap_per_class()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.bbox2dist"><code class="docutils literal notranslate"><span class="pre">bbox2dist()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.bbox_iou"><code class="docutils literal notranslate"><span class="pre">bbox_iou()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.box_iou"><code class="docutils literal notranslate"><span class="pre">box_iou()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_amp"><code class="docutils literal notranslate"><span class="pre">check_amp()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_dataset"><code class="docutils literal notranslate"><span class="pre">check_dataset()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_font"><code class="docutils literal notranslate"><span class="pre">check_font()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_img_size"><code class="docutils literal notranslate"><span class="pre">check_img_size()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_suffix"><code class="docutils literal notranslate"><span class="pre">check_suffix()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.check_version"><code class="docutils literal notranslate"><span class="pre">check_version()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.clip_boxes"><code class="docutils literal notranslate"><span class="pre">clip_boxes()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.compute_ap"><code class="docutils literal notranslate"><span class="pre">compute_ap()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.dist2bbox"><code class="docutils literal notranslate"><span class="pre">dist2bbox()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.fitness"><code class="docutils literal notranslate"><span class="pre">fitness()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.increment_path"><code class="docutils literal notranslate"><span class="pre">increment_path()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.intersect_dicts"><code class="docutils literal notranslate"><span class="pre">intersect_dicts()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.is_ascii"><code class="docutils literal notranslate"><span class="pre">is_ascii()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.is_writeable"><code class="docutils literal notranslate"><span class="pre">is_writeable()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.labels_to_class_weights"><code class="docutils literal notranslate"><span class="pre">labels_to_class_weights()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.make_anchors"><code class="docutils literal notranslate"><span class="pre">make_anchors()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.make_divisible"><code class="docutils literal notranslate"><span class="pre">make_divisible()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.non_max_suppression"><code class="docutils literal notranslate"><span class="pre">non_max_suppression()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.one_cycle"><code class="docutils literal notranslate"><span class="pre">one_cycle()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.one_flat_cycle"><code class="docutils literal notranslate"><span class="pre">one_flat_cycle()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.scale_boxes"><code class="docutils literal notranslate"><span class="pre">scale_boxes()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.scale_image"><code class="docutils literal notranslate"><span class="pre">scale_image()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.strip_optimizer"><code class="docutils literal notranslate"><span class="pre">strip_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.user_config_dir"><code class="docutils literal notranslate"><span class="pre">user_config_dir()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.xywh2xyxy"><code class="docutils literal notranslate"><span class="pre">xywh2xyxy()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.xyxy2xywh"><code class="docutils literal notranslate"><span class="pre">xyxy2xywh()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.yaml_load"><code class="docutils literal notranslate"><span class="pre">yaml_load()</span></code></a></li>
<li><a class="reference internal" href="#ycsai.utils.general.yaml_save"><code class="docutils literal notranslate"><span class="pre">yaml_save()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=af2ce170"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>